{"version":3,"file":"../admin-analytics-helper.js","sources":["admin-analytics-helper.js"],"sourcesContent":["/**\n * Google analytics helper\n */\n\n/*global Gianalytics:false*/\n\njQuery( document ).ready( function ( $ ) {\n\n\t'use strict';\n\n\t// Google Analytics\n\tvar gaProfile = function ( parent, callback ) {\n\t\tvar td = $( parent ).parents( 'td' );\n\t\ttd.addClass( 'loading' );\n\t\t$.ajax( {\n\t\t\ttype: 'GET',\n\t\t\turl: Gianalytics.endpoint,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tnonce: Gianalytics.nonce,\n\t\t\t\taction: Gianalytics.action,\n\t\t\t\ttarget: $( parent ).attr( 'id' ).replace( 'ga-', '' ),\n\t\t\t\taccount_id: $( '#ga-account' ).val(),\n\t\t\t\tprofile_id: $( '#ga-profile' ).val()\n\t\t\t},\n\t\t\tsuccess: function ( result ) {\n\t\t\t\ttd.removeClass( 'loading' );\n\t\t\t\tif ( result.success ) {\n\t\t\t\t\tvar select = $( '#' + $( parent ).attr( 'data-child' ) );\n\t\t\t\t\t$.each( result.items, function ( index, item ) {\n\t\t\t\t\t\tvar opt = document.createElement( 'option' );\n\t\t\t\t\t\t$( opt ).attr( 'value', item.id ).text( item.name );\n\t\t\t\t\t\tselect.append( opt );\n\t\t\t\t\t} );\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\tcallback( select );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\twindow.alert( result.message );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t};\n\n\t// Bind profile change.\n\t$( '.ga-profile-select', '#ga-connection' ).change( function () {\n\t\tvar threshold = parseInt( $( this ).attr( 'data-clear-target' ), 10 );\n\t\t// Clear all\n\t\t$( 'select', '#ga-connection' ).each( function ( index, elt ) {\n\t\t\tif ( index >= threshold ) {\n\t\t\t\t$( elt ).find( 'option' ).each( function ( i, option ) {\n\t\t\t\t\tif ( i > 0 ) {\n\t\t\t\t\t\t$( option ).remove();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t\t// Search\n\t\tgaProfile( this );\n\t} );\n\n\t// Fill\n\tvar accountSelect = $( '#ga-account' );\n\tif ( accountSelect.length && '0' !== accountSelect.attr( 'data-ga-account-id' ) ) {\n\t\tgaProfile( accountSelect, function ( profileSelect ) {\n\t\t\tprofileSelect.find( 'option' ).each( function ( index, option ) {\n\t\t\t\t// Make select box checked.\n\t\t\t\tif ( $( option ).attr( 'value' ) === profileSelect.attr( 'data-ga-profile-id' ) ) {\n\t\t\t\t\t$( option ).prop( 'selected', true );\n\t\t\t\t\tprofileSelect.addClass( 'success' );\n\t\t\t\t}\n\t\t\t} );\n\t\t\t// Ajax\n\t\t\tif ( '0' !== profileSelect.attr( 'data-ga-profile-id' ) ) {\n\t\t\t\tgaProfile( profileSelect, function ( viewSelect ) {\n\t\t\t\t\tviewSelect.find( 'option' ).each( function ( index, option ) {\n\t\t\t\t\t\t// Make select box checked.\n\t\t\t\t\t\tif ( $( option ).attr( 'value' ) === viewSelect.attr( 'data-ga-view-id' ) ) {\n\t\t\t\t\t\t\t$( option ).prop( 'selected', true );\n\t\t\t\t\t\t\tviewSelect.addClass( 'success' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t}\n\n\t// Check status\n\tvar checkGaStatus = function () {\n\t\tif ( '0' !== $( this ).val() ) {\n\t\t\t$( this ).addClass( 'success' );\n\t\t} else {\n\t\t\t$( this ).removeClass( 'success' );\n\t\t}\n\t};\n\t$( 'select', '#ga-connection' )\n\t\t.change( checkGaStatus )\n\t\t.each( checkGaStatus );\n\n\n\t// Cron checker\n\t$( '#cron-checker' ).submit( function ( e ) {\n\t\te.preventDefault();\n\t\tvar form = this;\n\t\t$( this ).ajaxSubmit( {\n\t\t\tdataType: 'json',\n\t\t\tsuccess: function ( result ) {\n\t\t\t\t$( form ).find( 'pre' ).text( JSON.stringify( result.items, function ( key, value ) {\n\t\t\t\t\treturn value;\n\t\t\t\t}, 4 ) );\n\t\t\t},\n\t\t\terror: function ( xhr, status, msg ) {\n\t\t\t\twindow.alert( msg );\n\t\t\t}\n\t\t} );\n\t} );\n\n\t// Ajax Checker\n\t$( '#ajax-checker' ).submit( function ( e ) {\n\t\te.preventDefault();\n\t\tvar $form = $( this ),\n\t\t\t$checked = $form.find( \"input[type=radio]:checked\" );\n\t\tif ( $checked.length ) {\n\t\t\t$form.find( 'input[name=_wpnonce]' ).val( $checked.attr( 'data-nonce' ) );\n\t\t\t$form.ajaxSubmit( {\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function ( result ) {\n\t\t\t\t\t$form.find( 'pre' ).text( JSON.stringify( result, function ( key, value ) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}, 4 ) );\n\n\t\t\t\t},\n\t\t\t\terror: function ( xhr, status, msg ) {\n\t\t\t\t\twindow.alert( msg );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n\n} );\n"],"names":["jQuery","document","ready","$","gaProfile","parent","callback","td","parents","addClass","ajax","type","url","Gianalytics","endpoint","dataType","data","nonce","action","target","attr","replace","account_id","val","profile_id","success","result","select","removeClass","each","items","index","item","opt","createElement","id","text","name","append","window","alert","message","checkGaStatus","this","change","threshold","parseInt","elt","find","i","option","remove","accountSelect","length","profileSelect","prop","viewSelect","submit","e","preventDefault","form","ajaxSubmit","JSON","stringify","key","value","error","xhr","status","msg","$form","$checked"],"mappings":"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"}